---
layout: post
title:  "2018-02-05 TIL WPS. 21 Models"
date:   2018-02-05 11:30:00 +0900
categories: TIL
---

### 모델 이해하기 

모델은 데이터에 대한 단일 정보 소스이며 저장하려는 데이터의 필수 필드와 동작이 포함되어 있다.

#### 모델 기초

- 각 모델은 django.db.models.Model의 하위클래스로 묶는 파이썬 클래스이다.
- 모델의 각 속성들은 데이터베이스 필드를 나타낸다.
- 장고는 자동으로 생성된 데이터베이스 액세스 API를 제공함

예제

```python
from django.db import models

class Person(models.Model):
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=30)
```

- 테이블 이름은 myapp_person으로 저절로 정의됨. 그러나 재정의 가능
- id(기본 키) field는 자동으로 생성되지만 다른 이름으로 덮어질 수 있다.
(기본 키는 관계형 DB에서 레코드의 식별자로 이용됨)

#### 모델 사용하기

모델을 정의한 후에 INSTALLED_APPS에 패키지(앱) 이름을 추가해야함.


#### 필드 옵션

#### null과 blank

blank = True면 값을 안넣어도 진행할 수 있게 함  -> form에서 빈값 전송

텍스트가 들어갈 수 있는 필드면 blank = True가 통하지만 그렇지 않은 몇몇의 필드에서는 에러를 발생시킨다.  
특히 DateField는  빈 텍스트를 저장할 수 없기 때문에 null=True를 해주어야함  

blank= True는 장고에서 그냥 처리가능
null = True는 데이터 베이스에서 Null값을 받을 수 있게 바꾸는 것이므로 migrate를 해주어야함

#### choices

```python
from django.db import models

class Person(models.Model):
    SHIRT_SIZES = (
        ('S', 'Small'),
        ('M', 'Medium'),
        ('L', 'Large'),
    )
    name = models.CharField(max_length=60)
    shirt_size = models.CharField(max_length=1, choices=SHIRT_SIZES)
```

```
>>> p = Person(name="Fred Flintstone", shirt_size="L")
>>> p.save()
>>> p.shirt_size
'L'
>>> p.get_shirt_size_display()
'Large'
```

#### primary_key

primary_key가 True면 기본 키가 모델에 사용되는 것을 의미한다. 하지만 설정하지 않더라도 자동으로 IntegerField가 추가되어 기본 키가 설정 될 것이다. 

pk는 읽기만 가능하다. 만약에 바꾸고 값을 저장한다면 새로운 객체가 만들어진다.

#### unique

유일한 값을 가지게 하는 속성
### Verbose field names

ForeignKEy, ManyToManyField, OneToOneField를 제외한 필드 타입의 선택적 첫번째 인수 ex)'이름'  -> 자세한 이름 속성

```python
from django.db import models

class Person(models.Model):
    SHIRT_SIZES = (
        ('S', 'Small'),
        ('M', 'Medium'),
        ('L', 'Large'),
    )
    name = models.CharField('이름', max_length=60)
    shirt_size = models.CharField(max_length=1, choices=SHIRT_SIZES)
```
ForeignKEy, ManyToManyField, OneToOneField의 필드 타입은 항상 첫 번째 인수로 모델의 클래스를 받기 때문에 verbose_name 키워드 인자로 받는다.

```python
poll = models.ForeignKey(
    Poll,
    on_delete=models.CASCADE,
    verbose_name="the related poll",
)
sites = models.ManyToManyField(Site, verbose_name="list of sites")
place = models.OneToOneField(
    Place,
    on_delete=models.CASCADE,
    verbose_name="related place",
)
```

### Relationships

관계형 데이터의 힘은 테이블을 서로 연관시키는 데 있다. Django는 세가지 관계형 데이터베이스를 정의하는 방법을 제공함

1. many-to-one
2. many-to-many
3. one-to-one


